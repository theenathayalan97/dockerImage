---
- name: Build image and with build args
  hosts: server
  become: True
  tasks:
    - name: Build Docker image
      community.docker.docker_image:
        name: myimage
        build:
          args:
            listen_port: 8002
        source: build












# ---
#   - name: Run using a project directory
#     hosts: server
#     gather_facts: no
#     tasks:
#       - name: Tear down existing services
#         docker_compose:
#           project_src: flask
#           state: absent

#       - name: Create and start services
#         docker_compose:
#           project_src: flask
#         register: output

#       - debug:
#           var: output

#       - name: Run `docker-compose up` again
#         docker_compose:
#           project_src: flask
#           build: no
#         register: output

#       - debug:
#           var: output

#       - assert:
#           that: "not output.changed "